# Mini-RAG-for-Movie-Plots
Mini RAG system for movie plots — a small retrieval-augmented generation demo that
lets you query movie plots using OpenAI embeddings + a local FAISS index.

## Overview
This repository contains two main entry points:
- `data-preprocessor.py` — reads the raw `wiki_movie_plots_deduped.csv`, filters and chunks plots (using spaCy) and writes `preprocessed_wiki_movies.csv`.
- `index.py` — loads the preprocessed CSV, creates/loads embeddings through the	OpenAI API, builds a FAISS index, and starts an interactive query loop.

## Prerequisites
- Python 3.10+ recommended
- A working internet connection for OpenAI API calls and spaCy model download
- An OpenAI API key (set as `OPENAI_API_KEY` in an `.env` file)

## Install dependencies
All required Python dependencies are listed in `requirements.txt`. From
PowerShell run:

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install --upgrade pip
pip install -r requirements.txt
```

Optionally pre-download the spaCy English model (the preprocessor will attempt to download it automatically if missing):

```powershell
python -m spacy download en_core_web_sm
```

## Running the data preprocessor
If `preprocessed_wiki_movies.csv` is not available in the project root, download the raw dataset (`wiki_movie_plots_deduped.csv`) from Kaggle and place it in the project root, then run the preprocessor.

Kaggle dataset: https://www.kaggle.com/datasets/jrobischon/wikipedia-movie-plots?resource=download&utm_source=chatgpt.com

From the project root run the preprocessor as shown below to generate `preprocessed_wiki_movies.csv`.

```powershell
# activate virtualenv if not already
.\.venv\Scripts\Activate.ps1
python data-preprocessor.py
```

After success you should see `preprocessed_wiki_movies.csv` created in the
project root.

## Running the RAG (`index.py`)
Purpose: load preprocessed chunks, generate embeddings using the OpenAI API,
build a FAISS index, and let you ask questions interactively.

1. Ensure `preprocessed_wiki_movies.csv` exists. If it does not, run the preprocessor as shown above.
2. Create a `.env` file in the project root with your OpenAI key (refer to .env.sample`):
```text
OPENAI_API_KEY=sk-xxxxxxx
```
3. Activate your virtualenv and run `index.py`:
```powershell
.\.venv\Scripts\Activate.ps1
python index.py
```

## Files of interest
- `data-preprocessor.py` — chunking and CSV creation
- `index.py` — RAG system, embeddings, FAISS index, interactive queries
- `utils.py` — small helpers (logging, sanitize_text, etc.)
- `preprocessed_wiki_movies.csv` — generated by the preprocessor (committed in this repo)
